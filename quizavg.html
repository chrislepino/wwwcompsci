<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<title>Hello, world!</title>
</head>
  <body class="bg-light">
	 <div class="container">
    <h1 class="col-12 bg-primary text-white text-center rounded"><b>Quiz Averager</b></h1>
		 <div class="d-none" id="errorDiv"></div>
		 <div class="input-group mx-5">
			 <div class="input-group-prepend">
				 <span for="scoreInpt" class="  py-2 input-group-text">Add a Quiz</span></div>
	<input type="text" id="scoreInpt" class="mr-0 form-control col-4" placeholder="Enter quiz score">
		<button id="submitbtn" type="button" class="btn btn-primary text-white col-2 mr-2 pr-0 input-group-append">Add New Quiz</button>
		<button class="btn btn-danger col-2 mr-2" id="clearBtn">CLEAR</button>
		<button class="btn btn-danger col-2"id="dropBtn">DROP LOWEST</button>
	</div>
<div class="d-flex flex-row py-2">
	<div class="d-flex flex-column h-100 col-6" style="flex:50%;">
	
    <h2 class="bg-success text-center text-white mx-4 rounded"><b>Current Scores</b></h2>

	<div id="scoreList" class="row text-center mx-4 border border-top-0"><b>Scores go here</b>
		 </div>
  
	</div>
			
		

	<div class="d-flex flex-column h-100 col-6" style="flex:50%;">
		<h2 class="bg-success text-center text-white mx-4 px-8 rounded"><b>Average</b></h2>
		<div id="avgList" class="  text-center px-8 border border-top-0 mx-4">
			 <b>Average of score</b></div>

	<div class="d-flex flex-row py-4">
		<button class="btn btn-info" id="initBtn">Add test scores</button>
		</div>
</div>
</div>
	  </div>
  </body>
	 <script>
	  let getId = (getFrm) =>{
		  return document.getElementById(getFrm)
	  }
	  const inptBox = getId("scoreInpt")
	  const submitBtn = getId("submitbtn")
	  const scoreList = getId("scoreList")
	  const avgList = getId("avgList")
	  const errorMsg = getId("errorDiv")
	  const dropBtn = getId("dropBtn")
	  const clearBtn = getId("clearBtn")
	  const initBtn = getId("initBtn")
	  var allScores = []
	  var avgScore = -1
	  let doDrop = false
	  var prevVal = 999
		 
	 let dropLowest = (scores) =>{
		 for(i=0; i<scores.length; i++){
			 if(scores[i]<prevVal){
				 prevVal = scores[i]
				 
			 }}
				return parseFloat(prevVal);
			 	console.log(prevVal)
		 
	 }
	  
	  
	  
	  
		 
	 let findAvg = (scores, doDrop) =>{
		 avgScore = 0
		 if(doDrop==true){
			 for(i=0; i<scores.length; i++){
			 avgScore += scores[i]}
			 
			 avgScore -= dropLowest(scores)
		 if (isNaN(avgScore)){
			 return 0
		 } else{
		 return avgScore/(scores.length-1)
		
		 }}
		 
		 
		 
		 if(doDrop==false) {
		 for(i=0; i<scores.length; i++){
			 avgScore = avgScore+ parseInt(scores[i])}
		 avgScore = avgScore/scores.length
		 if (isNaN(avgScore)){
			 return 0
		 } else{
		 return avgScore
		 }}
	 }
	 let printScores = (scores) =>{
		 scoreList.innerHTML = ""
		 for(i=0; i<scores.length; i++){
			 makeTags("div", scores[i], 1, "col-12 col-md-6 border", "scoreList", "quiz"+i)
		 }
	 }
	 
	 window.addEventListener('load', function(){
		 clearBtn.click()
		 
	 })
	 


	 
	 

	 
	 dropBtn.addEventListener('click', function(){
		 doDrop = !doDrop
		 console.log(doDrop)
		 avgList.innerHTML = findAvg(allScores, doDrop)
		 if(doDrop){
			 dropBtn.className = "btn btn-success col-2"
		 } else if (doDrop == false){
			 dropBtn.className = "btn btn-danger col-2"
		 }
	 })
		 
	clearBtn.addEventListener('click', function(){
		allScores.splice(0, allScores.length)
		printScores(allScores)
		  avgList.innerHTML = findAvg(allScores, doDrop)
		  inptBox.select()
		  inptBox.value = ""
		if (allScores.length==0){
			clearBtn.className = "btn btn-secondary col-2 mr-2 disabled"
		}

	})
	 
	  let makeTags = (tag, value, amt, cssClass, location, id) => { 
		  let tagValue =""
		  for(let i=0; i<amt; i++){
		   tagValue +="<" + tag + " class=" + '"' + cssClass + '"' + "id=" + '"' + id + '"' + ">" + value + "</" + tag + "> "}
		  getId(location).innerHTML += tagValue
		  return tagValue
		  console.log(tagValue)
	  }
	   getId("scoreList").addEventListener('click', function(e) {
		  var TARG = e.target.id
		  console.log(TARG)
		   var idNum = TARG.substring(4)
		   console.log(idNum)
		   allScores.splice(idNum,1);
		   TARG.innerHTML = ""
		   printScores(allScores)
			  avgList.innerHTML = findAvg(allScores, doDrop)

	  })
		 
	inptBox.addEventListener('keypress', function(e) {
		if (e.keyCode === 13){
		  submitBtn.click()
		}

		}
	)
		
	  submitBtn.addEventListener('click', function(e){
		  if (isNaN(inptBox.value) || inptBox.value == ""){
			  errorMsg.className = " d-flex col-12 bg-danger text-white text-center align-middle"

			  errorMsg.innerHTML = "<p>Please enter a numeric value!</p>"
			  for(i=0; i<2; i++){
				  $(errorMsg).fadeOut(600)
				  $(errorMsg).fadeIn(600)	
			  
			  }
			  
			  inptBox.value = ""
			  }else{
		  errorMsg.className = "d-none"
		  allScores.push(parseFloat(inptBox.value))
		  printScores(allScores)
		  avgList.innerHTML = findAvg(allScores, doDrop)
		  inptBox.select()
		  inptBox.value = ""}
		  clearBtn.className = "btn btn-danger col-2 mr-2"
	  })
		 
	
	initBtn.addEventListener('click', function(e){
			allScores.push(85, 44, 100, 22)
		   printScores(allScores)
		  avgList.innerHTML = findAvg(allScores, doDrop)
		  inptBox.select()
		  inptBox.value = ""
		  clearBtn.className = "btn btn-danger col-2 mr-2"
		
		
	})

	</script>
	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</html>